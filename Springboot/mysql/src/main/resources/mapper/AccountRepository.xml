<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//MYBATIS.org//DTD Mapper 3.0//EN" "http://MYBATIS.org/dtd/MYBATIS-3-mapper.dtd" >
<mapper namespace="com.example.mysql.repository.AccountRepository" >
    <!-- ResultMap -->
    <resultMap id="AccountResultMap" type="com.example.mysql.model.Account" >
        <result column="ID" property= "id" jdbcType= "INTEGER"/>
        <result column="LOGIN_NAME" property= "loginName" jdbcType= "VARCHAR"/>
        <result column="USERNAME" property= "username" jdbcType= "VARCHAR"/>
        <result column="PASSWORD" property= "password" jdbcType= "VARCHAR"/>
        <result column="ROLE_ID" property= "roleId" jdbcType= "VARCHAR"/>
        <result column="APPLICATION" property= "application" jdbcType= "VARCHAR"/>
        <result column="COMPANY" property= "company" jdbcType= "VARCHAR"/>
        <result column="GROUP_NAME" property= "groupName" jdbcType= "VARCHAR"/>
        <result column="TELPHONE" property= "telphone" jdbcType= "VARCHAR"/>
        <result column="FACE_LOCAL" property= "faceLocal" jdbcType= "VARCHAR"/>
        <result column="FACE_URL" property= "faceUrl" jdbcType= "VARCHAR"/>
    </resultMap>

    <!-- 全字段检索 -->
    <sql id="select_column_list">
        ID
        , LOGIN_NAME
        , USERNAME
        , PASSWORD
        , ROLE_ID
        , APPLICATION
        , COMPANY
        , GROUP_NAME
        , TELPHONE
        , FACE_LOCAL
        , FACE_URL
    </sql>

    <!-- 插入数据字段 -->
    <sql id="insert_column_list">
        ID
        , LOGIN_NAME
        , USERNAME
        , PASSWORD
        , ROLE_ID
        , APPLICATION
        , COMPANY
        , GROUP_NAME
        , TELPHONE
        , FACE_LOCAL
        , FACE_URL
    </sql>

    <!-- 通过ID查找唯一一条记录 -->
    <select id="selectOneById" resultMap="AccountResultMap">
        SELECT
            <include refid="select_column_list"></include>
        FROM ACCOUNT
        WHERE
            ID = #{id}
    </select>

    <!-- 根据条件取得件数 -->
    <select id="getCountByDto" parameterType="com.example.mysql.dto.AccountDto" resultType="java.lang.Integer">
        SELECT COUNT(*) FROM ACCOUNT
        <where>
            1 = 1
            <if test="password!=null and password!=''">
                AND PASSWORD = #{password}
            </if>
            <if test="roleId!=null and roleId!=''">
                AND ROLE_ID = #{roleId}
            </if>
            <if test="application!=null and application!=''">
                AND APPLICATION = #{application}
            </if>

            <if test="condition!=null and condition!=''">
                ${condition}
            </if>
        </where>
    </select>

    <!-- 根据条件取得一览 -->
    <select id="selectByDto" parameterType="com.example.mysql.dto.AccountDto" resultMap="AccountResultMap">
        SELECT
            <include refid="select_column_list"></include>
        FROM ACCOUNT
        <where>
            1 = 1
            <if test="password!=null and password!=''">
                AND PASSWORD = #{password}
            </if>
            <if test="roleId!=null and roleId!=''">
                AND ROLE_ID = #{roleId}
            </if>
            <if test="application!=null and application!=''">
                AND APPLICATION = #{application}
            </if>

            <if test="condition!=null and condition!=''">
                ${condition}
            </if>
        </where>
        <if test="orderBy!=null">
            ORDER BY ${orderBy}
        </if>
            LIMIT ${startRow} , ${pageSize}
    </select>

    <!-- 新增一条数据 -->
    <insert id="insert" parameterType="com.example.mysql.model.Account" >
        INSERT INTO ACCOUNT (
        <!-- <trim prefix='(' suffix=')' suffixOverrides=','> -->
        <include refid="insert_column_list"></include>
        ) VALUES (
        #{id}
        , #{loginName}
        , #{username}
        , #{password}
        , #{roleId}
        , #{application}
        , #{company}
        , #{groupName}
        , #{telphone}
        , #{faceLocal}
        , #{faceUrl}
        )
    </insert>

    <!-- 删除数据 -->
    <delete id="delete">
        DELETE FROM ACCOUNT WHERE ID = #{id}
    </delete>

    <!-- 更新数据 -->
    <update id="update" parameterType="com.example.mysql.model.Account" >
        UPDATE ACCOUNT
        <set>
        <if test="loginName!=null and loginName!=''">
            LOGIN_NAME = #{loginName},
        </if>
        <if test="username!=null and username!=''">
            USERNAME = #{username},
        </if>
        <if test="password!=null and password!=''">
            PASSWORD = #{password},
        </if>
        <if test="roleId!=null and roleId!=''">
            ROLE_ID = #{roleId},
        </if>
        <if test="application!=null and application!=''">
            APPLICATION = #{application},
        </if>
        <if test="company!=null and company!=''">
            COMPANY = #{company},
        </if>
        <if test="groupName!=null and groupName!=''">
            GROUP_NAME = #{groupName},
        </if>
        <if test="telphone!=null and telphone!=''">
            TELPHONE = #{telphone},
        </if>
        <if test="faceLocal!=null and faceLocal!=''">
            FACE_LOCAL = #{faceLocal},
        </if>
        <if test="faceUrl!=null and faceUrl!=''">
            FACE_URL = #{faceUrl},
        </if>
        </set>
        WHERE
            ID = #{id}
    </update>

    <!-- 业务主键查找唯一值 -->
    <select id="selectOneByUniqueKey" resultMap="AccountResultMap">
        SELECT
            <include refid="select_column_list"></include>
        FROM ACCOUNT
        <where>
            LOGIN_NAME = #{loginName}
            OR USERNAME = #{username}
            OR TELPHONE = #{telphone}
        </where>
    </select>

    <!-- 自定义查找 -->
    <select id="customQuary" parameterType="com.example.mysql.dto.AccountDto" resultType="com.example.mysql.model.Account">
        SELECT
             ${selectQuary}
        FROM ACCOUNT
        <if test="joinPart!=null">
            ${joinPart}
        </if>
        <where>
            1 = 1
            <if test="condition!=null and condition!=''">
             AND ${condition}
            </if>
        </where>
        <if test="groupBy!=null and groupBy!=''">
            GROUP BY ${groupBy}
        </if>
        <if test="having!=null and having!=''">
            HAVING ${having}
        </if>
        <if test="orderBy!=null and orderBy!=''">
            ORDER BY ${orderBy}
        </if>
    </select>
</mapper>
